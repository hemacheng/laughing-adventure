# é«˜éšè¨­è¨ˆæ–‡æª” (High-Level Design)

-   **æ–‡ä»¶ç‰ˆæœ¬**: v1.0.0
-   **ä½œè€…**: Gemini (è»Ÿé«”æ¶æ§‹å¸«)

---

## 1. æ¶æ§‹ç¸½è¦½ (Architecture Overview)

æœ¬å°ˆæ¡ˆå°‡æ¡ç”¨ã€Œ**å‰å¾Œç«¯åˆ†é›¢ (Headless)**ã€çš„ç¾ä»£ Web æ¶æ§‹ã€‚å¾Œç«¯å°‡ä½œç‚ºä¸€å€‹ç´”ç²¹çš„ **RESTful API** æœå‹™ï¼Œè€Œå‰ç«¯å°‡æ˜¯ä¸€å€‹ç¨ç«‹çš„å–®é æ‡‰ç”¨ (Single-Page Application, SPA)ã€‚

-   **è¨­è¨ˆåŸå‰‡èˆ‡å„ªé»**:
    1.  **ç¨ç«‹é–‹ç™¼èˆ‡éƒ¨ç½² (Independent Development & Deployment)**: å‰ã€å¾Œç«¯åœ˜éšŠå¯ä»¥ä½¿ç”¨å„è‡ªç¨ç«‹çš„æŠ€è¡“æ£§èˆ‡é–‹ç™¼æµç¨‹ä¸¦è¡Œå·¥ä½œï¼Œäº’ä¸é˜»å¡ã€‚å‰ç«¯å¯ä»¥éƒ¨ç½²åœ¨ Vercel/Netlify ç­‰éœæ…‹è¨—ç®¡å¹³å°ï¼Œå¾Œç«¯ API å¯ç¨ç«‹éƒ¨ç½²åœ¨ Heroku/Fly.io ç­‰æ‡‰ç”¨æœå‹™å¹³å°ï¼Œç™¼å¸ƒé€±æœŸæ›´éˆæ´»ã€‚
    2.  **æŠ€è¡“æ£§éˆæ´»æ€§ (Technology Stack Flexibility)**: æ­¤æ¶æ§‹ä¸å°‡å‰ç«¯èˆ‡å¾Œç«¯æŠ€è¡“ç¶å®šã€‚æœªä¾†è‹¥éœ€é–‹ç™¼åŸç”Ÿ App (iOS/Android) æˆ–å…¶ä»–å®¢æˆ¶ç«¯ï¼Œå®ƒå€‘éƒ½å¯ä»¥é‡è¤‡ä½¿ç”¨åŒä¸€å¥—å¾Œç«¯ APIï¼Œæœ€å¤§åŒ–ç¨‹å¼ç¢¼è¤‡ç”¨æ€§ä¸¦é™ä½é•·æœŸç¶­è­·æˆæœ¬ã€‚
    3.  **æ¸…æ™°çš„é—œæ³¨é»åˆ†é›¢èˆ‡æ“´å±•æ€§ (SoC & Scalability)**: å‰ç«¯å°ˆæ³¨æ–¼ UI/UXï¼Œå¾Œç«¯å°ˆæ³¨æ–¼æ¥­å‹™é‚è¼¯èˆ‡æ•¸æ“šè™•ç†ã€‚é€™ç¨®æ¸…æ™°çš„é‚Šç•Œä½¿å¾—ç³»çµ±æ›´å®¹æ˜“ç†è§£èˆ‡ç¶­è­·ã€‚åŒæ™‚ï¼Œå¾Œç«¯ API æœå‹™å¯ä»¥æ ¹æ“šè² è¼‰ç¨ç«‹é€²è¡Œæ“´å±•ï¼Œè€Œç„¡éœ€æ”¹å‹•å‰ç«¯ã€‚

-   **æºé€šæ–¹å¼**:
    -   å‰å¾Œç«¯å°‡åš´æ ¼é€é **RESTful API** é€²è¡ŒéåŒæ­¥é€šè¨Šã€‚
    -   æ‰€æœ‰æ•¸æ“šäº¤æ›æ ¼å¼çµ±ä¸€ç‚º **JSON**ã€‚

---

## 2. æŠ€è¡“é¸å‹èˆ‡ç†ç”± (Technology Stack & Justification)

ç‚ºæ»¿è¶³ MVP çš„å¿«é€Ÿé–‹ç™¼éœ€æ±‚ï¼Œä¸¦å…¼é¡§æœªä¾†çš„æ“´å±•æ€§ï¼Œå¾Œç«¯æŠ€è¡“é¸å‹å¦‚ä¸‹ï¼š

| æŠ€è¡“é ˜åŸŸ | é¸æ“‡ | é¸æ“‡ç†ç”± (WHY) |
| :--- | :--- | :--- |
| **Web æ¡†æ¶** | **Flask** | ä½œç‚ºä¸€å€‹è¼•é‡ç´šçš„ã€Œå¾®æ¡†æ¶ã€ï¼ŒFlask å•Ÿå‹•æˆæœ¬ä½ï¼Œå­¸ç¿’æ›²ç·šå¹³ç·©ï¼Œéå¸¸é©åˆ MVP éšæ®µã€‚å…¶è±å¯Œçš„æ“´å±•ç”Ÿæ…‹ï¼ˆå¦‚ Blueprintsï¼‰èƒ½ç¢ºä¿å°ˆæ¡ˆåœ¨åŠŸèƒ½è®Šè¤‡é›œæ™‚ï¼Œä»å¯ç¶­æŒè‰¯å¥½çš„çµæ§‹èˆ‡æ“´å±•æ€§ã€‚ |
| **è³‡æ–™åº«** | **PostgreSQL** | ä¸€æ¬¾åŠŸèƒ½å¼·å¤§ã€ç©©å®šå¯é çš„é–‹æºé—œè¯å¼è³‡æ–™åº«ã€‚å®ƒèƒ½è™•ç†è¤‡é›œçš„æ•¸æ“šé—œä¿‚æŸ¥è©¢ï¼Œå…·å‚™å„ªç•°çš„æ“´å±•æ€§ï¼Œè¶³ä»¥æ‡‰å°æœªä¾†ä½¿ç”¨è€…å¢é•·èˆ‡åŠŸèƒ½æ“´å±•çš„éœ€æ±‚ã€‚é–‹ç™¼éšæ®µå¯æ­é… **SQLite** ä»¥ç°¡åŒ–æœ¬æ©Ÿç’°å¢ƒè¨­å®šã€‚ |
| **ORM** | **SQLAlchemy** | Python ä¸–ç•Œä¸­åŠŸèƒ½æœ€å®Œæ•´ã€ç¤¾ç¾¤æœ€æ´»èºçš„ ORMã€‚å®ƒèƒ½å°‡è¤‡é›œçš„è³‡æ–™åº«æ“ä½œæŠ½è±¡åŒ–ç‚º Python ç‰©ä»¶ï¼Œæœ‰æ•ˆé™ä½ SQL æ³¨å…¥é¢¨éšªï¼Œä¸¦ä½¿è³‡æ–™åº«é‚è¼¯æ›´æ˜“æ–¼æ¸¬è©¦èˆ‡ç¶­è­·ã€‚æ­é… `Flask-SQLAlchemy` æ“´å±•å¯ç„¡ç¸«æ•´åˆã€‚ |
| **è³‡æ–™é©—è­‰** | **Marshmallow** | ç”¨æ–¼è¤‡é›œæ•¸æ“šçš„åºåˆ—åŒ–/ååºåˆ—åŒ–åŠé©—è­‰ã€‚åœ¨ API é–‹ç™¼ä¸­ï¼Œå®ƒèƒ½ç¢ºä¿å‚³å…¥çš„ JSON æ•¸æ“šç¬¦åˆé æœŸæ ¼å¼ï¼Œä¸¦èƒ½å„ªé›…åœ°å°‡ SQLAlchemy æ¨¡å‹ç‰©ä»¶è½‰æ›ç‚º JSONï¼Œæ˜¯æ§‹å»ºå¥å£¯ API çš„é—œéµå·¥å…·ã€‚ |

---

## 3. å¾Œç«¯å°ˆæ¡ˆçµæ§‹ (Backend Project Structure)

æˆ‘å€‘å°‡æ¡ç”¨ **Flask Blueprints** ä¾†çµ„ç¹”å°ˆæ¡ˆã€‚å…¶æ ¸å¿ƒç›®çš„æ˜¯å¯¦ç¾ã€Œ**é—œæ³¨é»åˆ†é›¢ (Separation of Concerns)**ã€ï¼Œå°‡æ‡‰ç”¨ç¨‹å¼æŒ‰åŠŸèƒ½æ¨¡çµ„ï¼ˆå¦‚ `auth`, `habits`, `moods`ï¼‰é€²è¡ŒåŠƒåˆ†ã€‚æ¯å€‹ Blueprint éƒ½æ˜¯ä¸€å€‹è¿·ä½ çš„ Flask æ‡‰ç”¨ï¼Œæ“æœ‰è‡ªå·±çš„è·¯ç”±ã€æ¨¡å‹å’Œæ¥­å‹™é‚è¼¯ï¼Œä½¿å¾—æ•´å€‹å°ˆæ¡ˆçµæ§‹æ¸…æ™°ã€æ˜“æ–¼ç¶­è­·ï¼Œä¸¦æ–¹ä¾¿åœ˜éšŠæˆå“¡åˆ†å·¥å”ä½œã€‚

æ¨è–¦çš„å°ˆæ¡ˆçµæ§‹å¦‚ä¸‹ï¼š

```
/mindtrack_api
|
|-- app/
|   |-- __init__.py             # âœ… App Factory: åˆå§‹åŒ– Flask æ‡‰ç”¨èˆ‡æ“´å±•
|   |-- blueprints/             # ğŸ“ æ ¸å¿ƒæ¨¡çµ„: å­˜æ”¾æ‰€æœ‰åŠŸèƒ½å°å‘çš„ Blueprint
|   |   |-- auth/               #    - èªè­‰æ¨¡çµ„ (è¨»å†Šã€ç™»å…¥)
|   |   |-- habits/             #    - ç¿’æ…£æ¨¡çµ„ (CRUD)
|   |   `-- moods/              #    - å¿ƒæƒ…æ¨¡çµ„ (CRUD)
|   |-- models/                 # ğŸ“ æ•¸æ“šæ¨¡å‹: å®šç¾©æ‰€æœ‰ SQLAlchemy çš„æ•¸æ“šåº«æ¨¡å‹
|   |-- schemas/                # ğŸ“ æ•¸æ“šé©—è­‰: å®šç¾©æ‰€æœ‰ Marshmallow çš„åºåˆ—åŒ–/é©—è­‰çµæ§‹
|   `-- services/               # ğŸ“ æ¥­å‹™é‚è¼¯: å­˜æ”¾è·¨æ¨¡çµ„çš„ã€è¼ƒè¤‡é›œçš„æ¥­å‹™é‚è¼¯å±¤
|
|-- migrations/                 # ğŸ“ æ•¸æ“šåº«é·ç§»: ç”± Flask-Migrate (Alembic) ç®¡ç†
|-- tests/                      # ğŸ“ æ¸¬è©¦: å­˜æ”¾æ‰€æœ‰å–®å…ƒæ¸¬è©¦èˆ‡æ•´åˆæ¸¬è©¦
|
|-- .env.example                # ğŸ“ ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
|-- config.py                   # âš™ï¸ è¨­å®šæª”: ç®¡ç†é–‹ç™¼ã€æ¸¬è©¦ã€ç”Ÿç”¢ç’°å¢ƒçš„è¨­å®š
|-- poetry.lock                 # ğŸ“¦ ä¾è³´é–å®š
|-- pyproject.toml              # ğŸ“¦ å°ˆæ¡ˆèˆ‡ä¾è³´ç®¡ç† (ä½¿ç”¨ Poetry)
`-- wsgi.py                     # ğŸš€ æ‡‰ç”¨å…¥å£: Gunicorn ç­‰ WSGI ä¼ºæœå™¨çš„é€²å…¥é»
```

---

## 4. é«˜éšæ¶æ§‹åœ– (High-Level Architecture Diagram)

æ­¤åœ–å±•ç¤ºäº†ç³»çµ±å„ä¸»è¦å…ƒä»¶ä¹‹é–“çš„äº’å‹•æµç¨‹ã€‚

```mermaid
graph TD
    subgraph "ä½¿ç”¨è€…ç«¯"
        Client["ä½¿ç”¨è€… (ç€è¦½å™¨)"]
    end

    subgraph "å‰ç«¯æ‡‰ç”¨ (Frontend)"
        FrontendApp["React / Vue.js App"]
    end

    subgraph "å¾Œç«¯æ‡‰ç”¨ (Backend API)"
        BackendAPI["Flask API"]
    end
    
    subgraph "è³‡æ–™åº« (Database)"
        DB[("Database (PostgreSQL / SQLite)")]
    end

    Client -- "è«‹æ±‚ (Request)" --> FrontendApp
    FrontendApp -- "API è«‹æ±‚" --> BackendAPI
    BackendAPI -- "æŸ¥è©¢ (Query)" --> DB
    DB -- "å›å‚³è³‡æ–™ (Data)" --> BackendAPI
    BackendAPI -- "API å›æ‡‰ (Response)" --> FrontendApp
    FrontendApp -- "æ›´æ–°ç•«é¢ (UI Update)" --> Client
```
